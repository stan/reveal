(function (a) { "use strict"; var b = { animation: "fadeAndPop", animationSpeed: 250, closeOnBackgroundClick: true, closeOnKey: 27, closeOnTimeout: false, dismissModalClass: "close-reveal-modal", revealedCallback: function () { }, dismissCallback: function () { }, contentUrl: false, contentId: false }; a("a[data-reveal-id]").live("click", function (b) { b.preventDefault(); a("#" + a(this).attr("data-reveal-id")).reveal(a(this).data()) }); a.fn.reveal = function (c) { if (typeof c === "object" || !c) { return this.each(function () { function k() { d.trigger("reveal:close") } var d = a(this), e = parseInt(d.css("top"), 10), f = d.height() + e, g = false, h = a(".reveal-modal-bg"), i = null, j = a.extend({}, b, c); d.bind("reveal:open", function () { if (h.length === 0) { h = a('<div class="reveal-modal-bg" />').insertAfter(d).fadeTo("fast", .8) } if (!g) { g = true; var b = { opacity: 1 }; d.css({ opacity: 0, top: a(document).scrollTop() + e, visibility: "visible" }); if (j.animation === "fadeAndPop") { d.css("top", a(document).scrollTop() - e); b.top = a(document).scrollTop() + e + "px" } else if (j.animation === "fade") { } else if (j.animation === "none") { d.css("opacity", 1); j.animationSpeed = 0 } h.fadeIn(j.animationSpeed / 2); d.delay(j.animationSpeed / 2).animate(b, j.animationSpeed, function () { if (typeof window[j.revealedCallback] === "function") { window[j.revealedCallback]() } }); if (j.closeOnBackgroundClick) { h.css("cursor", "pointer").bind("click", k) } if (j.closeOnKey) { a("body").keyup(function (a) { if (a.which === j.closeOnKey) { k() } }) } d.find("." + j.dismissModalClass).live("click", k) } g = false; d.unbind("reveal:open") }); d.bind("reveal:close", function () { if (!g) { g = true; var b = { opacity: 0 }, c = { top: e, visibility: "hidden" }; if (j.animation === "fadeAndPop") { b.top = a(document).scrollTop() - f + "px" } else if (j.animation === "fade") { } else if (j.animation === "none") { j.animationSpeed = 0 } d.animate(b, j.animationSpeed, function () { d.css(c) }); h.delay(j.animationSpeed).fadeOut(j.animationSpeed, function () { if (typeof window[j.dismissCallback] === "function") { window[j.dismissCallback]() } }) } clearTimeout(i); g = false; d.unbind("reveal:close") }); if (j.contentUrl) { if (j.contentId) { j.contentUrl += " #" + j.contentId } d.load(j.contentUrl, null, function () { a(this).append(a('<a class="close-reveal-modal">&#215;</a>')); d.trigger("reveal:open") }) } else { d.trigger("reveal:open") } d.trigger("reveal:open"); if (j.closeOnTimeout) { i = setTimeout(function () { d.trigger("reveal:close") }, j.closeOnTimeout) } }) } else if (c === "close") { return this.each(function () { a(this).trigger("reveal:close") }) } } })(jQuery)